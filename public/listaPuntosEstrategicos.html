<!DOCTYPE html>
<html lang="es">
    <head>
	<title>KAYPI-ADMIN</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/5.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
		<link rel="stylesheet" href="css/tw.css" />
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/5.0.0/js/bootstrap.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link href="https://fonts.googleapis.com/css2?family=Montserrat&family=Yanone+Kaffeesatz&display=swap" rel="stylesheet">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    </head>
    <body id="page-top">
	
		<div class="container register-form">
            <div class="row g-3">
                <div class="note">
                    <p>AÃ±adir Puntos Estrategicos</p>
                </div>
				<div class="row g-3">
					<div class="col-auto">
						<button onclick="goBack()" class="btn btn-primary btn-lg">Atras</button>
					</div>
					<div class="col-auto">
						<form action="/" method="get">
										<input type="submit" name="submit" class="btn btn-primary btn-lg" value="Inicio">
									</form>
								</div>
					<div class="col-auto">
						<form action="/logout" method="get">
							<input type="submit" name="submit" class="btn btn-danger btn-lg" value="Cerrar Sesion">
						</form>
					</div>
					<div class="col-auto">
						<form action="/puntos" method="get">
							<input type="submit" name="submit" class="btn btn-success btn-lg" value="Agregar">
						</form>
					</div>
					
				
				
				</div>
				<br>	
		<div class="container register-form">
            <div class="row g-3">
                <div class="note">
                    <p>Lista Puntos Estrategicos</p>
                </div>
				<table class="table table-hover table-striped"">
					<thead>
						<tr>
							<th>No.</th>
							<th>Nombre</th>
							<th>Categoria</th>
							<th>Zonas</th>
							<th>Descripcion</th>
                            <th>-</th>
							<th>-</th>
						</tr>
					</thead>
					<tbody id="alltodos">
					
                    </tbody>  
				</table>				
			<!-- Form-->
        </div>
		
    </body>
	
	<script>
	// Example starter JavaScript for disabling form submissions if there are invalid fields
	(function() {
	  'use strict';
	  window.addEventListener('load', function() {
		// Fetch all the forms we want to apply custom Bootstrap validation styles to
		var forms = document.getElementsByClassName('needs-validation');
		// Loop over them and prevent submission
		var validation = Array.prototype.filter.call(forms, function(form) {
		  form.addEventListener('submit', function(event) {
			if (form.checkValidity() === false) {
			  event.preventDefault();
			  event.stopPropagation();
			}
			form.classList.add('was-validated');
		  }, false);
		});
	  }, false);
	})();
	</script>
</html>

<script type="text/javascript">
	window.addEventListener('DOMContentLoaded', (e) =>{
	fetch('http://localhost:3000/listPuntos')
	.then(res => res.json())
	.then(data =>{
		if(data.response === 'success'){
			const todos = data.data; 
			var num = 1;
			
			todos.forEach(todo =>{
				console.log(todo);
	  document.querySelector('#alltodos').innerHTML += `
	  <td>${num}</td>
	  <td>${todo.Nombre}</td>
	  <td>${todo.Categoria}</td>
	  <td>${todo.ZonasCBBA}</td>
	  <td>${todo.Descripcion}</td>
	  <td>
        <a href="modPuntosEstrategicos.html?_id=${todo._id}"class="btn btn-primary">Modificar</a>
      </td>
		<td>
        <form action="/eliminarPunto" method="post">
        <input name="_id" value="${todo._id}" hidden>
        <input type="submit" name="submit" class="btn btn-danger" value="Eliminar">
        </form>
      </td>
				`;
				num++;
			});
		} else alert(data.response);
		
	})
	.catch(err => console.error(err));
  });
  function goBack() {
  window.history.back();
}

	  </script>