<!DOCTYPE html>
<html lang="es">
    <head>
	<title>KAYPI-ADMIN</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/5.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
		<link rel="stylesheet" href="css/tw.css" />
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/5.0.0/js/bootstrap.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link href="https://fonts.googleapis.com/css2?family=Montserrat&family=Yanone+Kaffeesatz&display=swap" rel="stylesheet">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    </head>
    <body id="page-top">
	
        
		<div class="container register-form">
            <div class="row g-3">
                <div class="note">
                    <p>Modificar Lineas</p>
                </div>
				<div class="row g-3">
					<div class="col-auto">
						<button onclick="goBack()" class="btn btn-primary btn-lg">Atras</button>
					</div>
					<div class="col-auto">
						<form action="/" method="get">
							<input type="submit" name="submit" class="btn btn-primary btn-lg" value="Inicio">
						  </form>
					</div>
                    <div class="col-auto">
                      <form action="/logout" method="get">
                        <input type="submit" name="submit" class="btn btn-danger btn-lg" value="Cerrar Sesion">
                      </form>
                    </div>
					<div class="col-auto">
						<form action="/listaLineas" method="get">
							<input type="submit" name="submit" class="btn btn-primary btn-lg" value="Ver Lista">
						</form>
					</div>
                   
					<div class="row g-3">
						<label class="text-control" for="cantidadPuntos">Ingrese la cantidad de calles de la linea:</label>
						<input type="number" class="form-control" name="cantidadPunto1" id="cantidadPunto1" min="1" max="20">
						<div class="form-text">El numero debe ser como minimo 1.</div>
						<label class="text-control" for="cantidadPuntos">Ingrese la cantidad de telefonos:</label>
						<input type="number" class="form-control" name="cantidadPunto2" id="cantidadPunto2" min="1" max="20">
						<div class="form-text">El numero debe ser como minimo 1.</div>
						<button onclick="GenerarListadeLineas()" id="btnLoadLines" class="btn btn-primary btn-lg">Cargar nuevos puntos para las lineas de transporte </button>
						</div>
					<div id="cargar">

					</div>
				</div>	
				<form action="/modificarLinea" method="post" id="formPrincipal" class="form-content" visibility="hidden">
					<input name="_id" id="_id" hidden>
			<label class="text-control" for="nombre">Nombre de Linea:</label>
			  <div class="form-group">
				  <input type="text" name="nombre" class="form-control" id="nombre" placeholder="Ingresar Linea + numero o letra de la linea *"  required>
				</div>
			<label class="text-control" for="categoria">Categoria:</label>
				<div class="form-group">
				  <input type="text" name="categoria" list="cat" class="form-control" id="categoria" placeholder="Ingresar Categoria Aqui"  required>
				  <datalist id="cat">
					<option value="Micro">
					<option value="Minibus">
					<option value="Taxitrufi">
				  </datalist>
				</div>					
			<label class="text-control" for="zona">Zona:</label>
				<div class="form-group">
				  <input type="text" name="zona" class="form-control" id="zona" placeholder="Ingresar Zona Aqui"  required>
				</div>
				<label class="text-control" for="pasaje">Pasajes:</label>
				<div class="form-group">
				  <input type="text" name="pasaje" class="form-control" id="pasaje1" placeholder="Ingresar Pasaje + Mayores Aqui *" required>
				</div>
				<div class="form-group">
					<input type="text" name="pasaje" class="form-control" id="pasaje2" placeholder="Ingresar Pasaje + Discapacidad Aqui *"  required>
				</div>
				<div class="form-group">
					<input type="text" name="pasaje" class="form-control" id="pasaje3" placeholder="Ingresar Pasaje + Universitario Aqui *"  required>
				</div>
				<div class="form-group">
					<input type="text" name="pasaje" class="form-control" id="pasaje4" placeholder="Ingresar Pasaje + Estudiantes Aqui *"  required>
				</div>
				<label class="text-control" for="validationDefault06">Calles:</label>
				<div id="cantCalles">
					
				</div>
				<div id="cantCallesForm">
				
				</div>
				<label class="text-control" for="validationDefault07">Telefonos:</label>
				<div id="cantTel">
					
				</div>
				<div id="cantTelForm">
				
				</div>
				<label class="text-control" for="horario">Horario:</label>
				<div class="form-group">
				  <input type="text" name="horario" class="form-control" id="horario" placeholder="Ingresar Horario Aqui *" required>
				</div>
				<br>
				<hr>
				<br>
				<h3>Rutas:</h3>
				<br>
			    <h3>Ruta Ida</h3>
			    <br>
				<div class="form-group">
					
					<div class="input-group mb-3">
						<span class="input-group-text" id="sentido1">Sentido</span>
						<input type="text" name="ruta1" class="form-control" aria-describedby="sentido1" id="ida"  required>
						
					</div>
					<div class="form-text">Añade un sentido de ruta como: NORTE-SUR.</div>
					<br>
					<input type="hidden" name="color1" value="rojo">

					<div id="googleMap1" style="width:100%;height:400px;"></div>
					<div class="form-text">Doble Click Para Agregar un marcador.</div>
					<br>
					<div class="row">
						<div class="col-auto">
							<input id="delete-markers1" type="button" value="Eliminar Lista de Marcadores Para Trazar la Linea con nuevas modificaciones" class="btn btn-danger btn-sm" />
							<div class="form-text">Elimina los puntos y traza una ruta basandote en la linea de la ruta anteriormente ingresada.</div>
						</div>
						<div class="col-auto"></div>
						<div class="col-auto">
							<input id="reload-markers1" type="button" value="Cargar Puntos Anteriormente Asignados" class="btn btn-primary btn-sm" />
							<div class="form-text">Recarga los puntos anteriormente registrados.</div>
						</div>
					</div>
					<br>
					<br>

					<div id="cantidadIda">
					
					</div>
					<div id="cantPuntosIda1">
				
					</div>
					<div id="cantPuntosIda2"></div>
				</div>
				
				<br>
				<hr>
				<br>
				<h3>Ruta Vuelta</h3>
				<br>
				<div class="form-group">
					<div class="input-group mb-3">
						<span class="input-group-text" id="sentido2">Sentido</span>
						<input type="text" name="ruta2" aria-describedby="sentido2" class="form-control" id="vuelta"  required>
						
					</div>
					<div class="form-text">Añade un sentido de ruta contrario a la ruta de ida como: SUR-NORTE.</div>
					<br>
					<input type="hidden" name="color2" value="azul">
					<br>
					<div id="googleMap2" style="width:100%;height:400px;"></div>
					<div class="form-text">Doble Click Para Agregar un marcador.</div>
					<br>
					<br>
					<div class="row">
						<div class="col-auto">
							<input id="delete-markers2" type="button" value="Eliminar Lista de Marcadores Para Trazar la Linea con nuevas modificaciones" class="btn btn-danger btn-sm" />
							<div class="form-text">Elimina los puntos y traza una ruta basandote en la linea de la ruta anteriormente ingresada.</div>
						</div>
						<div class="col-auto"></div>
						<div class="col-auto">
							<input id="reload-markers2" type="button" value="Cargar Puntos Anteriormente Asignados" class="btn btn-primary btn-sm" />
							<div class="form-text">Recarga los puntos anteriormente registrados.</div>
						</div>
					</div>					<br>
					<br>
					<div id="cantidadVuelta">
					
					</div>
					<div id="cantPuntosVuelta1">
				
					</div>
					<div id="cantPuntosVuelta2">
				</div>
				
				
				<br />
			<input class="btnSubmit" type="submit" value="Modificar">
		</form>
			<!-- Form-->
			
        </div>	
 	
    </body>
</html>

<script type="text/javascript">
	//Obtiene datos de un metodo get
function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
    results = regex.exec(location.search);
    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}
var _idVar = getParameterByName('_id');


</script>

<script type="text/javascript">
	var auxIda =0;
	var auxVuelta =0;
	 var tel=0;
	 var calle=0;
	 var todoObj;
	 var ruta1;
	 var ruta2;
	 //Carga los datos de listLineas con la diferencia que busca a una similitud de ids para cargar la linea que se requiere modiicar
	window.addEventListener('DOMContentLoaded', (e) =>{
	fetch('http://localhost:3000/listLineas')
	.then(res => res.json())
	.then(data =>{
		if(data.response === 'success'){
			const todos = data.data; 
			var num = 1;
			
			todos.forEach(todo =>{
				if(todo._id==_idVar){

					todoObj=todo;
					console.log(todoObj);
					var id= todoObj._id;
					var nombre= todoObj.Nombre;
					var categoria= todoObj.Categoria;
					var calles= todoObj.Calles;
					var pasaje1= todoObj.Pasajes[0];
					var pasaje2= todoObj.Pasajes[1];
					var pasaje3= todoObj.Pasajes[2];
					var pasaje4= todoObj.Pasajes[3];
					var zona= todoObj.ZonasCBBA[0];
					var telefonos= todoObj.Telefonos;
					var horarios= todoObj.Horarios;
					ruta1= todoObj.Rutas[0];
					ruta2= todoObj.Rutas[1];
					document.getElementById('_id').value =id;
					//document.getElementById('_id1').value =id;
					document.getElementById('nombre').value =nombre;
					document.getElementById('categoria').value =categoria;
					document.getElementById('zona').value =zona;
					document.getElementById('pasaje1').value =pasaje1;
					document.getElementById('pasaje2').value =pasaje2;
					document.getElementById('pasaje3').value =pasaje3;
					document.getElementById('pasaje4').value =pasaje4;


					
                    for (let index = 0; index < telefonos.length; index++) {
						document.querySelector('#cantTelForm').innerHTML +=`
						<div class="row g-3 align-items-center">
						 <div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="tel1">Telefono ${index+1}</span>
								<input type="text" name="telefono" class="form-control" id="tel1" placeholder="Ingresar Telefono Numero ${index}" value="${telefonos[index]}" required>
                            </div>
				
						 </div>
			            </div>
						`
						
					}
					console.log(todoObj.Calles);
					for (let index = 0; index < calles.length; index++) {
						document.querySelector('#cantCallesForm').innerHTML +=`
						<div class="row g-3 align-items-center">
						 <div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="calle">Calle ${index+1}</span>
								<input type="text" name="calle" class="form-control" id="calle" placeholder="Ingresar Calle Numero ${index}" value="${calles[index]}" required>
                            </div>
				
						 </div>
			            </div>
						`
						
					}
					document.getElementById('horario').value =horarios;
					var sentido1 =ruta1.Sentido;
					var sentido2 =ruta2.Sentido;
					document.getElementById('ida').value =sentido1;
					document.getElementById('vuelta').value =sentido2;


					for (let index = 0; index < ruta1.Puntos.length; index++) {
						   addMarker1( { lat: parseFloat(ruta1.Puntos[index].lat), lng: parseFloat(ruta1.Puntos[index].lng) }, map1);
					}
					for (let index = 0; index < ruta2.Puntos.length; index++) {
						addMarker2( { lat: parseFloat(ruta2.Puntos[index].lat), lng: parseFloat(ruta2.Puntos[index].lng) }, map2);
					}
                   const polylines1 = new google.maps.Polyline({
                     path: ruta1.Puntos,
                     geodesic: true,
                     strokeColor: "#FF0000",
                     strokeOpacity: 1.0,
                     strokeWeight: 2,
					 clickable: false
                   });
                 
                   polylines1.setMap(map1);
				   const polylines2 = new google.maps.Polyline({
                     path: ruta2.Puntos,
                     geodesic: true,
                     strokeColor: "#0000FF",
                     strokeOpacity: 1.0,
                     strokeWeight: 2,
					 clickable: false
                   });
                 
                   polylines2.setMap(map2);  
				   
				   tel =telefonos.length;
				   calle =calles.length;
				   document.getElementById('cantidadPunto1').value =calle;
				   document.getElementById('cantidadPunto2').value =tel;

					auxIda= todo.Rutas[0].Puntos.length;
					
					auxVuelta= todo.Rutas[1].Puntos.length;
				

					todoObj=todo;
					console.log(todoObj);
					var cantIda = auxIda;
				    var cantVuelta = auxVuelta;
			     	
					
				/* document.querySelector('#cantidadIda').innerHTML += `
				    <input type="hidden" name="cantIda" value="${cantIda}">
				    `;
			    	document.querySelector('#cantidadVuelta').innerHTML += `
				    <input type="hidden" name="cantVuelta" value="${cantVuelta}">
				    `;*/
					if(cantIda>0 && auxIda>0){
					for (let index = 0; index < auxIda; index++) {
						document.querySelector('#cantPuntosIda1').innerHTML += `
					<div class="row g-3 align-items-center">
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text" id="lat1">Latitud</span>
										<input type="text" class="form-control" name="lat1" id="lat1" placeholder="Ingrese la latitud" value="${todo.Rutas[0].Puntos[index].lat}" aria-label="Latitud" aria-describedby="lat" required>
									</div>
						
								</div>
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text" id="lng1">Longitud</span>
										<input type="text" class="form-control" id="lng1" name="lng1" placeholder="Ingrese la longitud" value="${todo.Rutas[0].Puntos[index].lng}" aria-label="Longitud" aria-describedby="lng" required>
									</div>
								</div>
					</div>
				`;			
					}
					for (let index = auxIda; index < cantIda; index++) {
						document.querySelector('#cantPuntosIda2').innerHTML += `
					<div class="row g-3 align-items-center">
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text" id="lat1">Latitud </span>
										<input type="text" class="form-control" name="lat1" id="lat1" placeholder="Ingrese la latitud" value="${todo.Rutas[0].Puntos[index].lat}" aria-label="Latitud" aria-describedby="lat" required>
									</div>
						
								</div>
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text" id="lng1">Longitud </span>
										<input type="text" class="form-control" id="lng1" name="lng1" placeholder="Ingrese la longitud" value="${todo.Rutas[0].Puntos[index].lng}" aria-label="Longitud" aria-describedby="lng" required>
									</div>
								</div>
					</div>
				`;			
					}
				}
                if(cantVuelta>0 && auxVuelta>0){
					for (let index = 0; index < auxVuelta; index++) {
						document.querySelector('#cantPuntosVuelta1').innerHTML += `
					<div class="row g-3 align-items-center">
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text" id="lat2">Latitud</span>
										<input type="text" class="form-control" name="lat2" id="lat2" placeholder="Ingrese la latitud" value="${todo.Rutas[1].Puntos[index].lat}" aria-label="Latitud" aria-describedby="lat">
									</div>
						
								</div>
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text" id="lng2">Longitud</span>
										<input type="text" class="form-control" id="lng2" name="lng2" placeholder="Ingrese la longitud" value="${todo.Rutas[1].Puntos[index].lng}" aria-label="Longitud" aria-describedby="lng">
									</div>
								</div>
					</div>
				`;			
					}
					for (let index = auxVuelta; index < cantVuelta; index++) {
						document.querySelector('#cantPuntosVuelta2').innerHTML += `
					<div class="row g-3 align-items-center">
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text" id="lat2">Latitud</span>
										<input type="text" class="form-control" name="lat2" id="lat2" placeholder="Ingrese la latitud" value="${todo.Rutas[1].Puntos[index].lat}" aria-label="Latitud" aria-describedby="lat">
									</div>
						
								</div>
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text" id="lng2">Longitud</span>
										<input type="text" class="form-control" id="lng2" name="lng2" placeholder="Ingrese la longitud" value="${todo.Rutas[1].Puntos[index].lng}" aria-label="Longitud" aria-describedby="lng">
									</div>
								</div>
					</div>
				`;		
					
				}
			}




			    }
			
				num++;
			});
		} else alert(data.response);
		
	})
	.catch(err => console.error(err));
	             
  });
  function GenerarListadeLineas() {
	document.querySelector('#cantCallesForm').innerHTML = ``;
	document.querySelector('#cantTelForm').innerHTML = ``;
		var btn = document.getElementById('btnLoadLines');
		inputIda = document.getElementById('cantidadPunto1');
		inputVuelta = document.getElementById('cantidadPunto2');
        var cantCalles = document.getElementById('cantidadPunto1').value;
        var cantTelefonos = document.getElementById('cantidadPunto2').value;
		inputIda.disabled=true;
		inputVuelta.disabled=true;
		btn.disabled=true;
		if(cantCalles < 1 || cantTelefonos < 1){
			alert("Los numeros para la cantidad de los telefonos y las calles deben ser mayores a 0");
			inputIda.disabled=false;
		    inputVuelta.disabled=false;
		    btn.disabled=false;
		}
		else{
		document.querySelector('#cantCalles').innerHTML += `
		<input type="hidden" name="cantCalles" value="${cantCalles}">
		
		`;
		document.querySelector('#cantTel').innerHTML += `
		<input type="hidden" name="cantTelefonos" value="${cantTelefonos}">
		
		`;
		if(cantCalles>0 && calle>0){
					for (let index = 0; index < calle; index++) {
						document.querySelector('#cantCallesForm').innerHTML += `
						<div class="row g-3 align-items-center">
						 <div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="calle">Calle ${index+1}</span>
								<input type="text" name="calle" class="form-control" id="calle" placeholder="Ingresar Telefono Numero ${index+1}" value="${todoObj.Calles[index]}" required>
                            </div>
				
						 </div>
			            </div>
						
						
				`;			
					}
					for (let index = calle; index < cantCalles; index++) {
						document.querySelector('#cantCallesForm').innerHTML += `
						<div class="row g-3 align-items-center">
						 <div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="calle">Calle ${index+1}</span>
								<input type="text" name="calle" class="form-control" id="calle" placeholder="Ingresar Calle Numero ${index+1}" required>
                            </div>
				
						 </div>
			            </div>
				`;			
					}
				}
                if(cantTelefonos>0 && tel>0){
					for (let index = 0; index < tel; index++) {
						document.querySelector('#cantTelForm').innerHTML += `
						<div class="row g-3 align-items-center">
						 <div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="tel1">Telefono ${index+1}</span>
								<input type="text" name="telefono" class="form-control" id="tel1" placeholder="Ingresar Telefono Numero ${index+1}" value="${todoObj.Telefonos[index]}" required>
                            </div>
				
						 </div>
			            </div>
						`;			
					}
					for (let index = tel; index < cantTelefonos; index++) {
						document.querySelector('#cantTelForm').innerHTML += `
						<div class="row g-3 align-items-center">
						 <div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="tel1">Telefono ${index+1}</span>
								<input type="text" name="telefono" class="form-control" id="tel1" placeholder="Ingresar Telefono Numero ${index+1}" required>
                            </div>
				
						 </div>
			            </div>
						`;		
					
				}
			}
		}
		
		
	} 
  	  </script>
	  	<script>
			  
		
				 //Recarga los datos de listLineas con si se requirio nuevos datos en los campos de puntos de ida y de vuelta con la unica diferencia que pregunta si los campos no son menores a los ya guardados en la base
			function reloadForm() {
				var btn = document.getElementById('btnLoadLines');
				cantIda = document.getElementById('cantidadPunto1').value;
				 cantVuelta = document.getElementById('cantidadPunto2').value;
	            var	inputIda = document.getElementById('cantidadPunto1');
		        var inputVuelta = document.getElementById('cantidadPunto2');
				if (inputIda.value < auxIda ||inputVuelta.value  < auxVuelta){
			          alert("Los numeros para la cantidad de puntos deben ser mayores a 2");
			          inputIda.disabled=false;
		              inputVuelta.disabled=false;
		              btn.disabled=false;
				}
				else{
					GenerarListadeLineas();
				}
				
			}
			//Ir una ventana atras del historial
			function goBack() {
               window.history.back();
            }
			//Carga los datos establecidos en el metodo GenerarListadeLineas
		
				var form = document.getElementById("formPrincipal");
				
			//Cuando se de click al submit se presentara la siguiente operacion de validaciones para los campos text que requieran ser numericos
    form.onsubmit = function() {
		var telefono = document.getElementById("tel1").value;
     	var z = document.getElementById("lat1").value;
     	var x = document.getElementById("lat2").value;
     	var c = document.getElementById("lng1").value;
     	var v = document.getElementById("lng2").value;	
		if(typeof telefono == 'number' && telefono.length<7 ||telefono.length>14){
		   alert("El telefono esta fuera del rango de caracteres establecido 7-14");
		   return false;
		}
		if(isNaN(telefono)){
			alert("El campo de telefono debe contener solo caractes numericos");
			return false;

		}	
		if(isNaN(Math.abs(z)))
        {
        alert("Por favor solo ingrese caracteres numericos en los campos de latitud");
		return false;
        }
		if(isNaN(Math.abs(x)))
        {
        alert("Por favor solo ingrese caracteres numericos en los campos de latitud");
		return false;
        }
		if(isNaN(Math.abs(c)))
        {
        alert("Por favor solo ingrese caracteres numericos en los campos de longitud");
		return false;
        }
		if(isNaN(Math.abs(v)))
        {
        alert("Por favor solo ingrese caracteres numericos en los campos de longitud");
		return false;
        }
	return true;
    }
	let map1,map2;
    var count=0;
	var markers1=[];
	var markers2=[];
    function initMap() {
		const cochabamba ={lat: -17.387783, lng: -66.155871}
        map1 = new google.maps.Map(document.getElementById("googleMap1"), {
        center: cochabamba,
		disableDoubleClickZoom: true,
		streetViewControl: false,
        zoom: 13,  
      });
        map2 = new google.maps.Map(document.getElementById("googleMap2"), {
        center: cochabamba,
		disableDoubleClickZoom: true,
		streetViewControl: false,
        zoom: 13,
      });
      google.maps.event.addListener(map1, "dblclick", (event) => {
		document.querySelector('#cantPuntosIda2').innerHTML = ``;
			addMarker1(event.latLng, map1);
			var myLatLng = event.latLng;
			var lat = myLatLng.lat();
            var lng = myLatLng.lng();
			document.querySelector('#cantPuntosIda1').innerHTML += `
			<div class="row g-3 align-items-center">
						<div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="lat1">Latitud</span>
								<input type="text" name="lat1" class="form-control" id="lat1" value="${lat}"  required>
                            </div>
						</div>
						<div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="lng1">Longitud</span>
								<input type="text" name="lng1" class="form-control" id="lng1" value="${lng}"  required>
                            </div>
						</div>		
			</div>
		`;			
			
      });
	  google.maps.event.addListener(map2, "dblclick", (event) => {
		document.querySelector('#cantPuntosVuelta2').innerHTML = ``;
			addMarker2(event.latLng, map2);
			var myLatLng = event.latLng;
            var lat = myLatLng.lat();
            var lng = myLatLng.lng();
			document.querySelector('#cantPuntosVuelta1').innerHTML += `
			<div class="row g-3 align-items-center">
						<div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="lat2">Latitud</span>
								<input type="text" name="lat2" class="form-control" id="lat2" value="${lat}"  required>
                            </div>
						</div>
						<div class="col-auto">
							<div class="input-group mb-3">
                                <span class="input-group-text" id="lng2">Longitud</span>
								<input type="text" name="lng2" class="form-control" id="lng2" value="${lng}"  required>
                            </div>
						</div>		
			</div>
		`;				
			
         
			count++;
      });
    }
	function addMarker1(location, map) {
        var marker1 = new google.maps.Marker({
        position: location,
        map: map
     });
	 marker1.addListener("dblclick", function() {
     marker1.setMap(null);
     });
    markers1.push(marker1);
    }
	 function addMarker2(location, map) {
        var marker2 = new google.maps.Marker({
        position: location,
        map: map
     });

     marker2.addListener("dblclick", function() {
     marker2.setMap(null);
     });
    markers2.push(marker2);
    }
	function setMapOnAll1(map) {
    for (var i = 0; i < markers1.length; i++) {
    markers1[i].setMap(map1);
    }
    }    

    function clearMarkers1() {
    setMapOnAll1(null);

    }

    function showMarkers1() {
    setMapOnAll1(map1);
    }
    function deleteMarkers1() {
    clearMarkers1();
	document.querySelector('#cantPuntosIda1').innerHTML = ``;
    markers1 = [];
    }
	function setMapOnAll2(map) {
    for (var i = 0; i < markers2.length; i++) {
    markers2[i].setMap(map2);
    }
    }    

    function clearMarkers2() {
    setMapOnAll2(null);

    }

    function showMarkers2() {
    setMapOnAll1(map2);
    }
    function deleteMarkers2() {
		console.log(markers2);

    clearMarkers2();
	document.querySelector('#cantPuntosVuelta1').innerHTML = ``;
    markers2 = [];
    }
	function removeMarkers1(){
	document.querySelector('#cantPuntosIda1').innerHTML = ``;
	document.querySelector('#cantPuntosIda2').innerHTML += `
					<div class="row g-3 align-items-center">
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text">Latitud</span>
										<input type="text" class="form-control" name="lat1" id="lat1" placeholder="Ingrese la latitud" aria-label="Latitud" aria-describedby="lat" required>
									</div>
						
								</div>
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text">Longitud</span>
										<input type="text" class="form-control" id="lng1" name="lng1" placeholder="Ingrese la longitud" aria-label="Longitud" aria-describedby="lng" required>
									</div>
								</div>
								<div class="col-auto">
									<div class="card" style="width: 25rem;">
                                      <img class="card-img-top" src="./img/routeGuide02.gif" alt="Card image cap">
                                    </div>
									<div class="card-footer">
                                      <small class="text-primary">Llene el formulario guiandose en las lineas para hacer las respectivas modificaciones</small>
                                    </div>
								</div>
					</div>
					<div class="form-text text-danger">Se requiere recargar las puntos o insertar nuevos en el respectivo mapa</div>
				`;			
	
    for(i=0; i<markers1.length; i++){
        markers1[i].setMap(null);
    }
	markers1 = [];
    }
	function removeMarkers2(){
	document.querySelector('#cantPuntosVuelta1').innerHTML = ``;
	document.querySelector('#cantPuntosVuelta2').innerHTML += `
					<div class="row g-3 align-items-center">
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text">Latitud</span>
										<input type="text" class="form-control" name="lat2" id="lat2" placeholder="Ingrese la latitud" aria-label="Latitud" aria-describedby="lat" required>
									</div>
						
								</div>
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text">Longitud</span>
										<input type="text" class="form-control" id="lng2" name="lng2" placeholder="Ingrese la longitud" aria-label="Longitud" aria-describedby="lng" required>
									</div>
								</div>
								<div class="col-auto">
									<div class="card" style="width: 25rem;">
                                      <img class="card-img-top" src="./img/routeGuide02.gif" alt="Card image cap">
                                    </div>
									<div class="card-footer">
									  <small class="text-primary">Llene el formulario guiandose en las lineas para hacer las respectivas modificaciones</small>
                                    </div>
								</div>
					</div>
					<div class="form-text text-danger">Se requiere recargar las puntos o insertar nuevos en el respectivo mapa</div>
					
				`;			
	
    for(i=0; i<markers2.length; i++){
        markers2[i].setMap(null);
    }
	markers2 = [];
    }

    function reloadMarkers1() {

		document.querySelector('#cantPuntosIda1').innerHTML = ``;
		document.querySelector('#cantPuntosIda2').innerHTML = ``;
		for (let index = 0; index < ruta1.Puntos.length; index++) {
			addMarker1( { lat: parseFloat(ruta1.Puntos[index].lat), lng: parseFloat(ruta1.Puntos[index].lng) }, map1);
		}	
		for (let index = 0; index < ruta1.Puntos.length; index++) {
						document.querySelector('#cantPuntosIda1').innerHTML += `
					<div class="row g-3 align-items-center">
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text">Latitud</span>
										<input type="text" class="form-control" name="lat1" id="lat1" placeholder="Ingrese la latitud" value="${ruta1.Puntos[index].lat}" aria-label="Latitud" aria-describedby="lat">
									</div>
						
								</div>
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text">Longitud</span>
										<input type="text" class="form-control" id="lng1" name="lng1" placeholder="Ingrese la longitud" value="${ruta1.Puntos[index].lng}" aria-label="Longitud" aria-describedby="lng">
									</div>
								</div>
								
					</div>
				`;			
			}		
    }

	function reloadMarkers2() {
		document.querySelector('#cantPuntosVuelta1').innerHTML = ``;
		document.querySelector('#cantPuntosVuelta2').innerHTML = ``;
		for (let index = 0; index < ruta2.Puntos.length; index++) {
			addMarker2( { lat: parseFloat(ruta2.Puntos[index].lat), lng: parseFloat(ruta2.Puntos[index].lng) }, map2);
        }
		for (let index = 0; index < ruta2.Puntos.length; index++) {
						document.querySelector('#cantPuntosVuelta1').innerHTML += `
					<div class="row g-3 align-items-center">
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text">Latitud</span>
										<input type="text" class="form-control" name="lat2" id="lat2" placeholder="Ingrese la latitud" value="${ruta2.Puntos[index].lat}" aria-label="Latitud" aria-describedby="lat">
									</div>
						
								</div>
								<div class="col-auto">
									<div class="input-group mb-3">
										<span class="input-group-text">Longitud</span>
										<input type="text" class="form-control" id="lng2" name="lng2" placeholder="Ingrese la longitud" value="${ruta2.Puntos[index].lng}" aria-label="Longitud" aria-describedby="lng">
									</div>
								</div>
					</div>
				`;			
			}	
	}
    document.getElementById("delete-markers1").addEventListener("click", removeMarkers1);
	document.getElementById("delete-markers2").addEventListener("click", removeMarkers2);
	document.getElementById("reload-markers1").addEventListener("click", reloadMarkers1);
	document.getElementById("reload-markers2").addEventListener("click", reloadMarkers2);
		</script>
		 <script
		 src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBY0Y6-0YKuzrsaoPmY4SjJAx93J6yeJb8&callback=initMap&v=weekly"
		 async
	   ></script>