<!DOCTYPE html>
<html lang="es">
    <head>
	<title>KAYPI-ADMIN</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/5.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
		<link rel="stylesheet" href="css/tw.css" />
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/5.0.0/js/bootstrap.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link href="https://fonts.googleapis.com/css2?family=Montserrat&family=Yanone+Kaffeesatz&display=swap" rel="stylesheet">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    </head>
    <body id="page-top">
	
		<div class="container register-form">
            <div class="row g-3">
                <div class="note">
                    <p>Modificar Puntos Estrategicos</p>
                </div>
				<div class="row g-3">
					<div class="col-auto">
						<button onclick="goBack()" class="btn btn-primary btn-lg">Atras</button>
					</div>
					<div class="col-auto">
						<form action="/" method="get">
							<input type="submit" name="submit" class="btn btn-primary btn-lg" value="Inicio">
						  </form>
					</div>
                    <div class="col-auto">
                      <form action="/logout" method="get">
                        <input type="submit" name="submit" class="btn btn-danger btn-lg" value="Cerrar Sesion">
                      </form>
                    </div>
					<div class="col-auto">
						<form action="/listaPuntos" method="get">
							<input type="submit" name="submit" class="btn btn-primary btn-lg" value="Ver Lista">
						</form>
					</div>
					
                  
				</div>	
			<!-- Form-->
			<div id="alltodos"></div>
			
        </div>		
    </body>
	
	<script>
	</script>
</html>

<script type="text/javascript">
	function getParameterByName(name) {
		name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
		var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
		results = regex.exec(location.search);
		return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
	}
	var _idVar = getParameterByName('_id');
	
	window.addEventListener('DOMContentLoaded', (e) =>{
	  fetch("http://localhost:3000/listPuntos")
	  .then(res => res.json())
	  .then(data =>{
		  if(data.response === 'success'){
			  const todos = data.data; 
			  var num = 1;
			  
			  todos.forEach(todo =>{
				if(todo._id==_idVar){
					document.querySelector('#alltodos').innerHTML += `
					
		<form action="/modificarPunto" method="post" class="form-content" id="formPrincipal" visibility="hidden">
			<input name="_id" id="_id" value="${_idVar}" hidden>
			<input type="text" name="_id1" class="form-control" name="_id1" value=${_idVar} disabled>
				<label class="text-control" for="validationDefault01">Nombre de Locación:</label>
				  <div class="form-group">
					  <input type="text" name="nombre" class="form-control" id="validationDefault01" placeholder="Ingrese el nombre" value="${todo.Nombre}" required>
					</div>
				<label class="text-control" for="validationDefault02">Categoria:</label>
					<div class="form-group">
					  <input type="text" name="categoria" list="cat" class="form-control" id="validationDefault02" placeholder="Ingrese la categoria" value="${todo.Categoria}" required>
					  <datalist id="cat">
						<option value="Centros Educativos">
						<option value="Centros de Transporte">
						<option value="Entidades Públicas">
						<option value="Centros Turísticos">
						<option value="Recreación y Cultura">
						<option value="Centros de Atención en Salud">
					  </datalist>
					  </div>					
				<label class="text-control" name="calles" for="validationDefault03">Calles:</label>
				    <div class="form-group">
					<textarea name="calles" class="form-control" id="validationTextarea" placeholder="Ingrese la calle" required>${todo.Calles[0]}</textarea>
					</div>
				<label class="text-control" for="validationDefault04">Zona:</label>
					<div class="form-group">
					  <input type="text" name="zona" class="form-control" id="validationDefault04" placeholder="Ingrese la zona" value="${todo.ZonasCBBA}" required>
					</div>
				<label class="text-control" class="text-control" for="validationDefault05">Lineas:</label>
				    <div class="form-group">
					  <textarea name="lineas" class="form-control" id="validationTextarea" placeholder="Ingrese la linea" required>${todo.Lineas[0]}</textarea>
					</div>									
				<label class="text-control" for="validationDefault04">Latitud:</label>
					<div class="form-group">
					  <input type="text" name="latitud" class="form-control" id="validationDefault05" value="${todo.Punto.lat}" required>
					</div>
				<label class="text-control" class="text-control" for="validationDefault05">Longitud:</label>
					<div class="form-group">
					  <input type="text" name="longitud" class="form-control" id="validationDefault06" value="${todo.Punto.lng}" required>
					</div>					
				<label class="text-control" for="validationTextarea">Descripción:</label>
					<div class="form-group">
					<textarea name="descripcion" class="form-control" id="validationTextarea" placeholder="Ingrese la descripcion" required>${todo.Descripcion}</textarea>
					</div>			
				<br />
				<input class="btnSubmit" type="submit" value="Registrar">
			</form>
				  `;
				}
		
			  });
		  } else alert(data.response);
		  
	  })
	  .catch(err => console.error(err));
	});
	
	function goBack() {
      window.history.back();
    }
	var form = document.getElementById("formPrincipal");
    form.onsubmit = function() {
	var z = document.getElementById("lat").value;
	var c = document.getElementById("lng").value;
		if(isNaN(Math.abs(z)))
        {
        alert("Por favor solo ingrese caracteres numericos en los campos de latitud");
		return false;
        }
		if(isNaN(Math.abs(c)))
        {
        alert("Por favor solo ingrese caracteres numericos en los campos de longitud");
		return false;
        }
	return true;
    }
	</script>